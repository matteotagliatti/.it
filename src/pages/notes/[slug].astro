---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";
import Bubble from "../../components/Bubble.astro";
import BubbleContainer from "../../components/BubbleContainer.astro";
import Item from "../../components/Item.astro";
import Link from "../../components/Link.astro";
import MarkdownBold from "../../components/MarkdownBold.astro";
import MarkdownLink from "../../components/MarkdownLink.astro";
import Photo from "../../components/Photo.astro";
import Layout from "../../layouts/Layout.astro";

export const getStaticPaths = (async () => {
  const notes = await getCollection("notes");

  return notes.map((note) => {
    return {
      params: {
        slug: note.data.titolo.toLowerCase().replace(/\s/g, "-"),
      },
      props: {
        note,
      },
    };
  });
}) satisfies GetStaticPaths;

const { note } = Astro.props;
const { Content } = await note.render();
---

<Layout title={note.data.titolo}>
  <Item>
    <Photo />
    <BubbleContainer>
      <Bubble>
        <p class="font-medium text-white">{note.data.titolo}</p>
      </Bubble>
      <Bubble>
        <p>{note.data.data}</p>
      </Bubble>
    </BubbleContainer>
  </Item>
  <Item>
    <Photo />
    <BubbleContainer>
      <Content
        components={{
          a: MarkdownLink,
          strong: MarkdownBold,
          p: Bubble,
        }}
      />
    </BubbleContainer>
  </Item>
  <Item>
    <Photo />
    <BubbleContainer>
      <Bubble seen={true}>
        <p>Go <Link href="/notes" blank={false} text="back" /></p>
      </Bubble>
    </BubbleContainer>
  </Item>
</Layout>
